<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ site_name or 'ModernBlog' }}{% endblock %}</title>
    <meta name="description" content="{% block description %}A modern blog with amazing content{% endblock %}">
    <meta name="keywords" content="{% block keywords %}blog, modern, content{% endblock %}">
    <meta name="author" content="{% block author %}{{ site_name or 'ModernBlog' }}{% endblock %}">
    <link rel="canonical" href="{{ request.url }}">
    
    <!-- Open Graph -->
    <meta property="og:title" content="{% block og_title %}{{ self.title() }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.description() }}{% endblock %}">
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:site_name" content="{{ site_name or 'ModernBlog' }}">
    {% block og_image %}{% endblock %}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ self.og_title() }}">
    <meta name="twitter:description" content="{{ self.og_description() }}">
    {% block twitter_image %}{% endblock %}
    
    <!-- JSON-LD Structured Data -->
    {% block structured_data %}{% endblock %}
    
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --primary-color: #1173d4; }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        @media (max-width: 640px) { .hero-h { height: 200px; } .card-h { height: 300px; } }
        
        /* Theme classes */
        body.dark {
            background-color: #111827;
            color: #ffffff;
        }
        body.light {
            background-color: #ffffff;
            color: #1f2937;
        }
        
        /* Dark theme styles */
        .dark .bg-gray-900 { background-color: #111827; }
        .dark .bg-gray-800 { background-color: #1f2937; }
        .dark .bg-gray-700 { background-color: #374151; }
        .dark .text-white { color: #ffffff; }
        .dark .text-gray-300 { color: #d1d5db; }
        .dark .text-gray-400 { color: #9ca3af; }
        .dark .border-gray-700 { border-color: #374151; }
        
        /* Dark theme search bar */
        .dark input[type="search"] {
            background-color: rgba(31, 41, 55, 0.5) !important;
            color: #ffffff !important;
            border-color: #374151 !important;
        }
        .dark input[type="search"]::placeholder {
            color: #9ca3af !important;
        }
        
        /* Light theme styles */
        .light .bg-gray-900 { background-color: #f8fafc; }
        .light .bg-gray-800 { background-color: #ffffff; }
        .light .bg-gray-700 { background-color: #f1f5f9; }
        .light .text-white { color: #0f172a; }
        .light .text-gray-300 { color: #334155; }
        .light .text-gray-400 { color: #64748b; }
        .light .border-gray-700 { border-color: #cbd5e1; }
        .light header { background-color: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .light footer { background: linear-gradient(135deg, #f1f5f9, #e2e8f0, #f8fafc); }
        
        /* Light theme search bar */
        .light input[type="search"] {
            background-color: #f1f5f9 !important;
            color: #1f2937 !important;
            border-color: #cbd5e1 !important;
        }
        .light input[type="search"]::placeholder {
            color: #64748b !important;
        }
        
        /* Light theme buttons */
        .light button {
            color: #0f172a;
        }
        .light button:hover {
            background-color: #e2e8f0;
        }
        
        /* Light theme form buttons */
        .light button[type="submit"] {
            background-color: #3b82f6 !important;
            color: #ffffff !important;
        }
        .light button[type="submit"]:hover {
            background-color: #2563eb !important;
        }
        
        /* Light theme social share buttons */
        .light .bg-blue-500 {
            background-color: #3b82f6 !important;
            color: #ffffff !important;
        }
        .light .bg-blue-500:hover {
            background-color: #2563eb !important;
        }
        .light .bg-blue-600 {
            background-color: #2563eb !important;
            color: #ffffff !important;
        }
        .light .bg-blue-600:hover {
            background-color: #1d4ed8 !important;
        }
        .light .bg-blue-700 {
            background-color: #1d4ed8 !important;
            color: #ffffff !important;
        }
        .light .bg-blue-700:hover {
            background-color: #1e40af !important;
        }
        
        /* Light theme navigation buttons */
        .light .bg-gray-800 {
            background-color: #ffffff !important;
            color: #0f172a !important;
            border: 1px solid #e2e8f0;
        }
        .light .bg-gray-800:hover {
            background-color: #f8fafc !important;
            border-color: #cbd5e1;
        }
        
        /* Light theme category badges */
        .light .bg-blue-600\/20 {
            background-color: #eff6ff !important;
            color: #1e40af !important;
            border: 1px solid #bfdbfe;
        }
        
        /* Light theme tag buttons */
        .light .bg-gray-700\/50 {
            background-color: #ffffff !important;
            color: #475569 !important;
            border: 1px solid #e2e8f0 !important;
        }
        .light .bg-gray-700\/50:hover {
            background-color: #f8fafc !important;
            color: #1e293b !important;
            border-color: #cbd5e1 !important;
        }
        
        /* Light theme slideshow text */
        .light .slide h1 {
            color: #ffffff !important;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        .light .slide p {
            color: #f3f4f6 !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }
        .light .slide a {
            background-color: #3b82f6 !important;
            color: #ffffff !important;
        }
        
        /* Light theme mobile menu */
        .light #mobile-menu {
            background-color: rgba(255, 255, 255, 0.95) !important;
        }
        .light #mobile-menu .border-gray-700 {
            border-color: #e2e8f0 !important;
        }
        .light #mobile-menu a {
            color: #1f2937 !important;
        }
        .light #mobile-menu a:hover {
            color: #3b82f6 !important;
        }
        
        /* Light theme comment form */
        .light input, .light textarea {
            background-color: #ffffff !important;
            color: #1f2937 !important;
            border-color: #d1d5db !important;
        }
        .light input:focus, .light textarea:focus {
            border-color: #3b82f6 !important;
            box-shadow: 0 0 0 1px #3b82f6 !important;
        }
        .light label {
            color: #374151 !important;
        }
        
        /* Light theme links */
        .light a {
            color: #2563eb;
        }
        .light a:hover {
            color: #1d4ed8;
        }
        
        /* Light theme text colors */
        .light .text-blue-400 {
            color: #1d4ed8 !important;
        }
        .light .text-gray-500 {
            color: #64748b !important;
        }
        
        /* Light theme card improvements */
        .light article {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .light article:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* Code block enhancements */
        .code-block {
            position: relative;
            margin: 1.5rem 0;
        }
        .code-header {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem 0.5rem 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
        }
        .dark .code-header {
            background: #374151;
            color: #d1d5db;
        }
        .light .code-header {
            background: #e2e8f0;
            color: #475569;
        }
        .copy-btn {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid;
        }
        .dark .copy-btn {
            background: #1f2937;
            border-color: #374151;
            color: #d1d5db;
        }
        .dark .copy-btn:hover {
            background: #374151;
            color: #ffffff;
        }
        .light .copy-btn {
            background: #f8fafc;
            border-color: #e2e8f0;
            color: #475569;
        }
        .light .copy-btn:hover {
            background: #e2e8f0;
            color: #1f2937;
        }
        .prose code {
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
            font-weight: 500;
        }
        .dark .prose code {
            background: #0f172a;
            color: #10b981;
        }
        .light .prose code {
            background: #f1f5f9;
            color: #059669;
        }
        .prose pre {
            border-radius: 0 0 0.5rem 0.5rem;
            margin-top: 0 !important;
            overflow-x: auto;
            border: 1px solid;
        }
        .dark .prose pre {
            background: #0f172a !important;
            border-color: #374151;
        }
        .light .prose pre {
            background: #f1f5f9 !important;
            border-color: #e2e8f0;
        }
        .prose pre code {
            background: transparent;
            padding: 1rem;
            display: block;
        }
        .dark .prose pre code {
            color: #e5e7eb;
        }
        .light .prose pre code {
            color: #374151;
        }
    </style>
    
    {% if tracking_code %}
    {{ tracking_code|safe }}
    {% endif %}
    
    {% if ads_header %}
    {{ ads_header|safe }}
    {% endif %}
</head>
<body class="font-sans transition-colors duration-300 dark" id="body">
<div class="flex min-h-screen flex-col bg-gray-900 text-white">

<!-- Mobile Menu -->
<div id="mobile-menu" class="fixed inset-0 z-50 hidden bg-gray-900/95 backdrop-blur md:hidden">
<div class="flex h-full flex-col">
<div class="flex items-center justify-between p-4 border-b border-gray-700">
<h2 class="text-lg font-bold">Menu</h2>
<button id="close-menu" class="p-2 hover:bg-gray-800 rounded">
<span class="material-symbols-outlined">close</span>
</button>
</div>
<nav class="flex-1 p-4 space-y-4">
<a href="{{ url_for('index') }}" class="block py-3 text-lg text-white border-b border-gray-700">Home</a>
<a href="{{ url_for('categories') }}" class="block py-3 text-lg text-gray-400 hover:text-white border-b border-gray-700">Categories</a>
{% for menu_item in menu_items %}
<a href="{{ menu_item.url }}" class="block py-3 text-lg text-gray-400 hover:text-white border-b border-gray-700">{{ menu_item.title }}</a>
{% endfor %}
<div class="pt-4">
<form action="{{ url_for('search') }}" method="GET" class="relative">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">search</span>
<input name="q" class="w-full h-12 rounded-lg bg-gray-800 pl-10 pr-4 text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500" placeholder="Search..." type="search"/>
</form>
</div>
</nav>
</div>
</div>

<header class="sticky top-0 z-40 w-full border-b border-gray-700/50 bg-gray-900/90 backdrop-blur">
<div class="mx-auto max-w-7xl flex items-center justify-between px-4 py-3">
<div class="flex items-center gap-3">
<svg class="h-7 w-7 text-blue-500" fill="currentColor" viewBox="0 0 48 48">
<path d="M24 18.4L42 11.5V34.4c0 .4-.3.8-.6.9L24 42V18.4z"/>
<path d="M24 8.2l9.4 3.4L24 15.2l-9.4-3.8L24 8.2z"/>
</svg>
<h1 class="text-lg font-bold">{{ site_name or 'ModernBlog' }}</h1>
</div>
<nav class="hidden md:flex items-center gap-6 text-sm">
<a class="text-white hover:text-blue-400" href="{{ url_for('index') }}">Home</a>
<a class="text-gray-400 hover:text-blue-400" href="{{ url_for('categories') }}">Categories</a>
{% for menu_item in menu_items[:2] %}
<a class="text-gray-400 hover:text-blue-400" href="{{ menu_item.url }}">{{ menu_item.title }}</a>
{% endfor %}
</nav>
<div class="flex items-center gap-3">
<div class="hidden sm:block">
<form action="{{ url_for('search') }}" method="GET" class="relative">
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">search</span>
<input name="q" class="h-9 w-48 rounded-lg bg-gray-800/50 pl-9 pr-3 text-sm text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500" placeholder="Search..." type="search"/>
</form>
</div>
<button class="p-2 hover:bg-gray-800 dark:hover:bg-gray-800 light:hover:bg-gray-100 rounded transition-colors" id="theme-toggle">
<span class="material-symbols-outlined text-sm" id="theme-icon">light_mode</span>
</button>
<button class="md:hidden p-2 hover:bg-gray-800 dark:hover:bg-gray-800 light:hover:bg-gray-100 rounded transition-colors" id="mobile-menu-btn">
<span class="material-symbols-outlined">menu</span>
</button>
</div>
</div>
</header>

<!-- Main Content -->
<main class="flex-1">
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="mx-auto max-w-7xl px-4 py-4">
                {% for message in messages %}
                    <div class="bg-green-600/20 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg mb-4">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    {% block content %}{% endblock %}
</main>

<footer class="border-t border-gray-700/50 bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 mt-12">
<div class="mx-auto max-w-7xl px-4 py-8">
<div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4">
<div class="col-span-1 sm:col-span-2 lg:col-span-1">
<div class="flex items-center gap-2 mb-4">
<svg class="h-6 w-6 text-blue-500" fill="currentColor" viewBox="0 0 48 48">
<path d="M24 18.4L42 11.5V34.4c0 .4-.3.8-.6.9L24 42V18.4z"/>
<path d="M24 8.2l9.4 3.4L24 15.2l-9.4-3.8L24 8.2z"/>
</svg>
<h3 class="text-lg font-bold">{{ site_name or 'ModernBlog' }}</h3>
</div>
<p class="text-sm text-gray-400 leading-relaxed">Discover the latest in technology, programming, and digital innovation through our expert articles and tutorials.</p>
</div>
<div>
<h4 class="text-sm font-semibold text-white mb-3">Quick Links</h4>
<ul class="space-y-2 text-sm text-gray-400">
<li><a href="{{ url_for('index') }}" class="hover:text-white transition-colors">Home</a></li>
<li><a href="{{ url_for('categories') }}" class="hover:text-white transition-colors">Categories</a></li>
{% for menu_item in menu_items[:2] %}
<li><a href="{{ menu_item.url }}" class="hover:text-white transition-colors">{{ menu_item.title }}</a></li>
{% endfor %}
</ul>
</div>
<div>
<h4 class="text-sm font-semibold text-white mb-3">Categories</h4>
<ul class="space-y-2 text-sm text-gray-400">
{% for category in categories[:4] %}
<li><a href="{{ url_for('category_posts', slug=category.slug) }}" class="hover:text-white transition-colors">{{ category.name }}</a></li>
{% endfor %}
</ul>
</div>
<div>
<h4 class="text-sm font-semibold text-white mb-3">Connect</h4>
<div class="flex gap-3">
<a href="#" class="text-gray-400 hover:text-white transition-colors">
<svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/></svg>
</a>
<a href="#" class="text-gray-400 hover:text-white transition-colors">
<svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg>
</a>
<a href="#" class="text-gray-400 hover:text-white transition-colors">
<svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001.012.001z"/></svg>
</a>
</div>
</div>
</div>
<div class="border-t border-gray-700/50 mt-8 pt-6 text-center">
<p class="text-sm text-gray-400">&copy; {{ current_year }} {{ site_name }}. All rights reserved.</p>
</div>
</div>
</footer>

{% if ads_footer %}
{{ ads_footer|safe }}
{% endif %}

</div>

<script>
// Mobile menu
const mobileMenuBtn = document.getElementById('mobile-menu-btn');
const mobileMenu = document.getElementById('mobile-menu');
const closeMenuBtn = document.getElementById('close-menu');

function toggleMobileMenu() {
 mobileMenu.classList.toggle('hidden');
 document.body.classList.toggle('overflow-hidden');
}

mobileMenuBtn?.addEventListener('click', toggleMobileMenu);
closeMenuBtn?.addEventListener('click', toggleMobileMenu);
mobileMenu?.addEventListener('click', (e) => {
 if (e.target === mobileMenu) toggleMobileMenu();
});

// Theme toggle
const themeToggle = document.getElementById('theme-toggle');
const themeIcon = document.getElementById('theme-icon');
const body = document.body;

function setTheme(theme) {
 body.classList.remove('dark', 'light');
 body.classList.add(theme);
 if (themeIcon) {
 themeIcon.textContent = theme === 'dark' ? 'light_mode' : 'dark_mode';
 }
 localStorage.setItem('theme', theme);
}

// Load saved theme
const savedTheme = localStorage.getItem('theme') || 'dark';
setTheme(savedTheme);

themeToggle?.addEventListener('click', () => {
 const currentTheme = body.classList.contains('dark') ? 'dark' : 'light';
 setTheme(currentTheme === 'dark' ? 'light' : 'dark');
});

// Code copy functionality
function addCodeCopyButtons() {
 document.querySelectorAll('pre code').forEach((block, index) => {
 const pre = block.parentElement;
 if (pre.querySelector('.copy-btn')) return;
 
 const wrapper = document.createElement('div');
 wrapper.className = 'code-block';
 
 const header = document.createElement('div');
 header.className = 'code-header';
 
 const language = block.className.match(/language-(\w+)/)?.[1] || 'code';
 const langSpan = document.createElement('span');
 langSpan.textContent = language;
 
 const copyBtn = document.createElement('button');
 copyBtn.className = 'copy-btn';
 copyBtn.innerHTML = '<span class="material-symbols-outlined text-xs">content_copy</span> Copy';
 
 header.appendChild(langSpan);
 header.appendChild(copyBtn);
 
 pre.parentNode.insertBefore(wrapper, pre);
 wrapper.appendChild(header);
 wrapper.appendChild(pre);
 
 copyBtn.addEventListener('click', async () => {
 try {
 await navigator.clipboard.writeText(block.textContent);
 copyBtn.innerHTML = '<span class="material-symbols-outlined text-xs">check</span> Copied!';
 setTimeout(() => {
 copyBtn.innerHTML = '<span class="material-symbols-outlined text-xs">content_copy</span> Copy';
 }, 2000);
 } catch (err) {
 copyBtn.textContent = 'Failed to copy';
 setTimeout(() => {
 copyBtn.innerHTML = '<span class="material-symbols-outlined text-xs">content_copy</span> Copy';
 }, 2000);
 }
 });
 });
}

// Initialize code copy buttons when page loads
document.addEventListener('DOMContentLoaded', addCodeCopyButtons);
</script>

</body>
</html>