{% extends "admin/base.html" %}

{% block page_title %}{% if page %}Edit Page{% else %}New Page{% endif %}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">
            {% if page %}Edit Page{% else %}Create New Page{% endif %}
        </h2>
        <a href="{{ url_for('admin_pages') }}" 
           class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i>Back to Pages
        </a>
    </div>

    <form method="POST" class="space-y-6">
        <div class="bg-white rounded-lg shadow p-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Main Content -->
                <div class="lg:col-span-2 space-y-6">
                    <div>
                        <label for="title" class="block text-sm font-medium text-gray-700 mb-2">Page Title</label>
                        <input type="text" 
                               id="title" 
                               name="title" 
                               value="{{ page.title if page else '' }}"
                               required 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                               placeholder="About Us, Contact, Privacy Policy, etc.">
                    </div>

                    <div>
                        <label for="slug" class="block text-sm font-medium text-gray-700 mb-2">Custom URL Slug (Optional)</label>
                        <input type="text" 
                               id="slug" 
                               name="slug" 
                               value="{{ page.slug if page else '' }}"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                               placeholder="contact, about-us, privacy-policy">
                        <p class="text-sm text-gray-500 mt-1">Leave empty to auto-generate from title. URL will be: /page/your-slug</p>
                    </div>

                    <div>
                        <label for="content" class="block text-sm font-medium text-gray-700 mb-2">Content (Markdown)</label>
                        <textarea id="content" 
                                  name="content" 
                                  rows="20"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ page.content if page else '' }}</textarea>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="space-y-6">
                    <!-- Publish -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="font-medium text-gray-800 mb-3">Publish</h3>
                        <div class="space-y-3">
                            <label class="flex items-center">
                                <input type="checkbox" 
                                       name="published" 
                                       {% if not page or page.published %}checked{% endif %}
                                       class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2 text-sm text-gray-700">Published</span>
                            </label>
                            <button type="submit" 
                                    class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                                {% if page %}Update Page{% else %}Create Page{% endif %}
                            </button>
                        </div>
                    </div>

                    <!-- Page Info -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="font-medium text-gray-800 mb-3">Page Info</h3>
                        <div class="text-sm text-gray-600 space-y-2">
                            <p><strong>URL:</strong> /page/{{ page.slug if page else 'auto-generated' }}</p>
                            {% if page %}
                            <p><strong>Created:</strong> {{ page.created_at.strftime('%B %d, %Y') }}</p>
                            {% if page.updated_at != page.created_at %}
                            <p><strong>Updated:</strong> {{ page.updated_at.strftime('%B %d, %Y') }}</p>
                            {% endif %}
                            {% endif %}
                        </div>
                    </div>

                    <!-- Common Pages -->
                    <div class="bg-blue-50 rounded-lg p-4">
                        <h3 class="font-medium text-blue-800 mb-3">Common Pages</h3>
                        <div class="text-sm text-blue-700 space-y-1">
                            <p>• About Us</p>
                            <p>• Contact</p>
                            <p>• Privacy Policy</p>
                            <p>• Terms of Service</p>
                            <p>• Disclaimer</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Initialize EasyMDE markdown editor for pages
    const easyMDE = new EasyMDE({
        element: document.getElementById('content'),
        spellChecker: false,
        toolbar: [
            'bold', 'italic', 'heading', '|',
            'quote', 'unordered-list', 'ordered-list', '|',
            'link', 'table', '|',
            'preview', 'side-by-side', 'fullscreen', '|',
            'guide'
        ],
        placeholder: 'Write your page content here using Markdown...'
    });
</script>
{% endblock %}